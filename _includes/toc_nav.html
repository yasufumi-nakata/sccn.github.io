{%- comment -%}_includes/nav.html からのコピー{%- endcomment -%}
{%-titled_pages =include.nav を割り当てる
        |where_exp:「item」・「item.title != nil」 -%の}
  {%- comment -%}
    `title` と `nav_order` の値は数値または文字列です。
    Jekyllは、異なるタイプの混合物をソートする際にビルドの失敗を与えます。
    数値と文字列は別にソートする必要があります。

    ここで、数値は値によってソートされ、すべての文字列の前に来ます。
    省略された `nav_order` 値がページの `title` 値と同等です。
    (数値 `title` の値が文字列として扱われる場合を除きます)。

    文字列ソートのケース感度は `site.nav_sort` で決定されます。
  {%- endcomment -%}
  
  {%- 文字列を割り当てる_ordered_pages = titled_pages
        |where_exp:「item」・「item.nav_order == nil」 -%の}
  {%- nav_ordered_pages = titled_pages を割り当てる
        |where_exp:「item」・「item.nav_order != nil」 -%の}

  {%- comment -%}
    nav_ordered_pages は number_ordered_pages に追加され、
    string_ordered_pages は nav_order の値に依存します。
    jsonify 結果の最初の文字は ```` です。文字列のみです。
  {%- endcomment -%}
  {%- nav_ordered_groups = nav_ordered_pages を割り当てる
        | group_by_exp:「item」・「item.nav_order」 | jsonify | スライス: 0" -%}
  {%- assign number_ordered_pages = "" | split:"X" -%}
  {%- for group in nav_ordered_groups -%}
    {%- if group.name == '"' -%}
      {%- assign string_ordered_pages = string_ordered_pages | concat: group.items -%}
    {%- else -%}
      {%- assign number_ordered_pages = number_ordered_pages | concat: group.items -%}
    {%- endif -%}
  {%- endfor -%}
  
  {%- assign sorted_number_ordered_pages = number_ordered_pages | sort:"nav_order" -%}
  
  {%- comment -%}
    string_ordered_pages は nav_order によってソートされなければならず、そうでなければ title
    (空の文字列を数値タイトルに追加すると文字列に変換されます)。
    これらの値でそれらをグループ化した後、グループはソートされ、その後、項目
    各グループが集約されます。
  {%- endcomment -%}
  {%-割り当て string_ordered_groups = string_ordered_pages ディレクティブ
        | group_by_exp:「item」・「item.nav_order」 | デフォルト: item.title | append:」 -%の}
  {%- if site.nav_sort == 'case_insensitive' -%}
    {%- assign sorted_string_ordered_groups = string_ordered_groups | sort_natural:"name" -%}
  {%- else -%}
    {%- assign sorted_string_ordered_groups = string_ordered_groups | sort:"name" -%}
  {%- endif -%}
  {%- assign sorted_string_ordered_pages = "" | split:"X" -%}
  {%- for group in sorted_string_ordered_groups -%}
    {%- assign sorted_string_ordered_pages = sorted_string_ordered_pages | concat: group.items -%}
  {%- endfor -%}

  {%- assign pages_list = sorted_number_ordered_pages | concat: sorted_string_ordered_pages -%}

<ul>
  {% for item in pages_list %}
	{% if item.long_title %}
    	    <li><a href="">{{ item.url }}">{{ item.long_title }}</a></li>
  	{%- else -%}
    	    <li><a href="">{{ item.url }}">{{ item.title }}</a></li>
  	{%- endif -%}
  {% endfor %}
</ul>
  {%- comment -%}
    {%- assign children_list = site.pages | where: "parent", item.title -%}
    {% if children_list %}
      {% include toc_nav.html nav=children_list %}
    {% endif %}
  {%- endcomment -%}
