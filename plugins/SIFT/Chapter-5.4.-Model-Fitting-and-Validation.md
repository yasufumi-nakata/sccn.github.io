---
layout: default
parent: SIFT
grand_parent: Plugins
render_with_liquid: false

title: Chapter-5.4.-Model-Fitting-and-Validation
nav_title: "Chapter-5.4.-モデル-フィッティングと検証"
long_title: Chapter-5.4.-Model-Fitting-and-Validation
---
データの処理が完了したら、**Model Fittingに進みます。
そして検証**。 SIFTは現在、パラメトリックVARモデリングをサポートしています
Vieira-Morf(Marple、1987)、またはARFITアルゴリズム(Schneider)
ノイマイヤー、2001年) ARFITは別途ダウンロードしてインストールする必要があります
<SIFT directory>/external/arfit/)。 現在、SIFT は時間管理をサポートしています
パラメトリック 滑走窓の使用によるVARモデリング
適応型VARモデリング(**)`est_fitMVAR()`**)または再帰的鎖角
カルマンフィルタリング (**)`est_fitMVARKalman()`**).

モデルフィッティングとバリデーションはコマンドラインから起動することもできます。

``` matlab
EEG = pop_est_fitMVAR(EEG);
```

下の図に表示するようなGUIが表示されます。 お問い合わせ
MVARアルゴリズムを選択し、スライドウィンドウの長さとステップを選択できます。
サイズ、モデルの注文を指定します。 ARFITは、修正された少なくとも正方形を使用する
Vieira-Morf がマルチチャネル幾何学的手段を使用する間アプローチ
モデル係数の解決のための非端角格子アプローチ。
ARFITは、プロセスの平均のための追加の用語が含まれています。
Vieira-Morf はゼロ・メタプロセスを想定しています。 現在の実装
ARFIT は Vieira-Morf アルゴリズムよりも高速ですが、
Vieira-Morf は、わずかに優れた係数推定値を返します。 お問い合わせ
これらの他の推定者との間の詳細なパフォーマンス比較を参照してください。
Schlögl(2006年)。 この例では Vieira-Morf アルゴリズムを使用します。
また、**ステップで0.4秒(400ms)**の**ウィンドウ長を使用します。
サイズ** 0.01秒(10ms) 2.5Hzの約1サイクル
oscillation は情報の流れを適切にモデル化し、
私たちのNyquistまでの関心(デルタ)の最も低い周波数帯から
128のHzの頻度。より多くののための理論セクションに相談して下さい
適切なウィンドウの長さを選択するための詳細。 

お問い合わせ
セクションに記載されている情報基準の1つ以上を計算する
3.5. モデルの注文の範囲に(*p)<sub>ツイート</sub>* まで
*p<sub>マックス</sub>*)。 複数のウィンドウが利用できる場合、
各ウィンドウに情報基準が計算され、ヒストグラムは
最適なモデルオーダーの配布を生成します。
窓。 多数の窓があり、時間のために押されていれば、
計算するウィンドウのランダムな割合を指定できます。
基準(**%のウィンドウでサンプル**)。 しかし、それは、
使用されるウィンドウの数が増えると、より良い見積もりになります
全体の情報基準の定期的な分布の
窓。 また、高速で見積りを見積もります。
情報基準は、モデルの**downdate**に選択できます
(Neumaierとシュナイダー、2001年) フィッティングpよりもむしろ<sub>マックス</sub> –
ツイート<sub>ツイート</sub> 注文が増えるVARモデルは、これは単一の
VAR\[*p]<sub>マックス</sub>※\) モデル、ノイズコワランスの更新
情報基準の推定値を取得する行列。

下記の図に示すように、以下の表に示すようにGUIが表示されます。

|                           |                 |
|---------------------------|-----------------|
| オプション | バリュー |
お問い合わせ **MVARアルゴリズムを選択してください** | **Vieira-Morf ** |
|****************************
お問い合わせ **ステップサイズ(秒)** | **0.01** |
|**************************************** お問い合わせ
| マンション** |
|**************************************** お問い合わせ
| ※Windowsからサンプルへ** |**100** |

![画面ショット 2023-08-24 に 11 00 35 PM](https://github.com/sccn/SIFT/assets/1872705/fdffcad0-2fe5-457e-aff3-cc5ca0247f26)

*充填キャプション。 AMVARモデルフィッティングGUI によって生成される**`pop_est_fitMVAR()`**。 0.01秒のステップサイズである0.4秒のウィンドウ長を選択し、1〜30秒のモデル注文範囲(注文選択用)を指定します。 * 必須

先に進む前に、オプションのウィンドウの長さを選択する方法を見てみましょう。

## 5.4.1. 理論: ウィンドウの長さを選択

適切な窓の長さを選ぶのに役立ついくつかの重要な考慮事項があります。 適切なウィンドウの長さは、次の考慮事項の1つ以上の妥協を必要とします。
1. 地方自治体
2. 一時的なスムース
3. 十分なデータ量
4. プロセス 動的および神経生理学

### 5.4.1.1. 地方自治体

3.4. セクションでは、非静止EEGデータを取り巻く問題について議論し、VARモデルに合ったスライドウィンドウの概念を導入しました。 <em>現地局局</em> データ。 そのため、局所的な局所性を確保するために私たちの窓が十分に小さいことが重要である。 このページでは、モデルを検証し、選択したウィンドウのサイズの安定性指数をプロットすることで、当社のウィンドウが十分に小さいかのように、ローカルの文様を確保するために感心できます。</p>

### 5.4.1.2. 一時的なスムース

滑走窓の分析は本質的に気道の滑らかになる操作です。 より大きなウィンドウは、データがますます長いセグメント上に集約されるモデル係数で、したがって、一時的なスムースが増加しました。 プロセスの動的に急激な変化がある場合、大きすぎるウィンドウを選択すると、情報フローの微細な一時的な構造が失われる可能性があります。 複数の試験が利用可能な場合、Ding et al. (2000b) によって提案された有用なヒューリスティックは、ウィンドウの長さの粗大な上限の制限を得るためのものです。バイバリエートの相関をすべての試験に数組の変数をプロットすることです。1 点のウィンドウで始まり、試行中の相関を巧みに検証し、ウィンドウ全体でます。 Ding et al. (2000b) のイラストを下図に再現しました。 1点のウィンドウでは、相関構造(バランスの取れない非静電性)に大きな変動があります。 窓の長さを増加させると、気道のスムースが増加します。 この場合、合理的なウィンドウの長さは10ポイントになる可能性があります。なぜなら、ローカルの共燃性非静電性(交差相関のローカル変動)を削減するからです。しかしながら、関心の一時的な動線の一部をまだ保存している間(すなわち、相関構造の変化)。 もちろん、この提案されたウィンドウの長さは完全にアプリケーション固有のものです。特定のデータに合わせたウィンドウを選択する必要があります。

![スクリーンショット 2023-08-24 に 11 12 34 PM](https://github.com/sccn/SIFT/assets/1872705/6eb22833-3329-472a-8066-654a206ee285)

*充填キャプション。 2つのintracranial EEGの時間シリーズ間の相互相関は増加の窓の長さ(1ポイント、10ポイント、20ポイント)に平均し、時間の機能としてプロットしました。 Ding et al. (2000b) から再現された図です。 * 必須

### 5.4.1.3. 十分なデータ量

セクション 3.4.1. 最小限のことを指摘しました。 <em>ツイート<sup>2</sup>ツイート</em> データポイントは、データポイントに収まる必要があります。 <em>ツイート</em>-次元VAR[p]モデル。 また、慣行では、多くのデータポイント**が不公平なフィット(モデルオーダーが15の場合、モデルに合った150以上のデータポイント)を確保するために、多くのデータポイント**を保有したいと思います。 これはルールの親指の式につながる:

<img src="https://latex.codecogs.com/svg.latex?{ {M}^{2} }p\le \left( \frac{1}{10} \right)NW">

または、等しく、 

<img src="https://latex.codecogs.com/svg.latex?W\ge 10\left( \frac{ { {M}^{2} }p}{N} \right)">

どこまでも <em>ツイート</em> ポイントのウィンドウの長さです。 <em>ネクタイ</em> トライアルの合計数です。 SIFT はパラメータのチェックを実行します()<strong><code>est_checkMVARParams()</code></strong>) 選択したウィンドウの長さがサブに最適かどうかを知らせます(また、より良いウィンドウの長さをお勧めします)。

### 5.4.1.4. プロセス動的および神経生理学

セクション3.5.では、適切なモデルの注文を選択すると、データの一時的な動的および神経生理学を考慮する必要があります。 窓の長さの選択のための同じ原則は握ります。 しかし、多くの試行錯誤で、窓の長さを短くすることでモデルを理論的にフィットすることができました。 <em>p+1の</em> 長いサンプルポイントは、選択したウィンドウ内で、モデル化されたすべてのインタラクションが行われる必要があることを考慮する必要があります。 一般的には、最大のインタラクションラグを期待する場合 <img src="https://latex.codecogs.com/svg.latex?\tau "> 2つの脳プロセス間の秒は、ウィンドウの長さを必ず選択するようにします <em>ツイート</em> <img src="https://latex.codecogs.com/svg.latex?\tau ">.

さらに、周波数ドメインの量に興味がある場合は、時間頻度の不確実性の原則を考慮する必要があります。これは、すべての一時的な解像度の増加が周波数分解のconcomitant減少につながる状態です。 一般的に、有用なルールの親指は、ウィンドウが関心の最低頻度の約1サイクルに及ぶのに十分な長さであることを確認することです。


## 5.4.2 . モデルの注文を選択する

VARアルゴリズム、ウィンドウの長さ、ステップサイズを選択しました。
注文解析のモデル化を進めます。 前のGUIで**OK**を押すと 下の警告画面が表示されます。 ショー
パラメータの比率を評価するサニティチェックの結果
データポイントは、推定周波数の数を計算し、チェックします
時間頻度プロダクトは他の関連した点検を実行し。 インフォメーション
各条件に表示され、最適な提案
パラメータ選択がサブに最適かどうかを使用するパラメータ。 お問い合わせ
データポイントへの無料パラメータの比率が警告されている
懸念を引き起こす可能性がある0.1よりも大きい。 これが私たちの理由です
30以上のモデルオーダーはかなり大きいです。 先に進み、これを無視しましょう
エラー(我々 は、我々 にフィットするとき、はるかに低いモデルの注文を使用する可能性があります)
最終モデル)。 同じ理由は、短いウィンドウサイズ(0.4秒)の警告のために行きます。 単に**OK**を押します。

![スクリーンショット 2023-08-24 に 11 01 40 PM](https://github.com/sccn/SIFT/assets/1872705/0970316e-6302-48db-9106-becacdd37d92)

*充填キャプション。 この GUI は、サニティチェックの結果をオンに表示します。
指定されたモデルパラメータ(これはモデルの前に常に実行されます)
付属品)。 * 必須

プログレッシブバーは、それぞれの進捗状況を示す必要があります
条件(*RespCorr*、*RespWrong*)。 これが完了したら、
以下に示す結果の数字を参照してください。 左は結果です
※RespWrong*のモデル注文選択と、右側は結果です。
*RespCorr* をリクエストします。 トップパネルは情報基準(平均)を示しています
窓を渡る)モデルとモデルをプロットしました。 縦行は各基準の基準を示す
平均最適モデルオーダー(情報を最小限に抑えるモデルオーダー)
基準)。 ヒストグラムの下部配列は、
各ウィンドウごとに最適なモデルオーダーの配布
基準。 注意, セクションで述べたように 3.5., 多くのウィンドウのために,
AICとFPEの基準は、クリアな最小限を展示することができません。
指定されたモデル範囲。 対照的に、SBCは明確な最低のピークを示す
*p*=5 の周り(我々 ができる限り少ない)
HQ が示す間、変数の各ペアの 2.5 のスペクトルピークを推定して下さい
*respWrong*および*RespCorr*の*p*=10のまわりの明確な最低。 ただし、両方の*RespWrong*と*RespCorr*では、
モデルの注文選択基準の上限はおよそです
*p*=15. ※RespCorr*のトップパネルをクリックすると拡大します。
パネルの表示。 同様に、ヒストグラムをクリックして
HQはヒストグラムの拡大された眺めを現れます。 シェード領域は、オプションのモデル順序の90%が続く範囲を示し、「20+-6」は、各モデルの注文選択基準に対する平均と標準偏差を示します。 注意:
HQ 基準 (pleple) の最小値が *p*=13 であるが、
HQ 基準の「肘」の上限は *p*=15 か
*p*=16. AIC/FPE は、SBC と HQ と比較して約 20 の大きな値を示しています。
そのためには、すべての人に適し、安全なモデルの注文をすることを結論づけるかもしれません。
窓および条件は*p*=15です。

![スクリーンショット 2023-08-24 に 11 38 39 PM](https://github.com/sccn/SIFT/assets/1872705/a5f08d2a-8366-4cc2-b9af-1af5078415af)

*充填キャプション。 モデルの注文選択の結果
**RespWrong**(左)と**RespCorr**(右)。 トップパネルは、
モデルの注文と平均最適を示す情報基準
選択した条件のモデル注文。 * 必須

![スクリーンショット 2023-08-24 に 11 48 05 PM](https://github.com/sccn/SIFT/assets/1872705/d5abe97f-b9d5-4723-b189-b025ad6892e5)

*充填キャプション。 左:SBC(青)、HQのクローズアップビュー
(紫色)、FPE(黄色)、AIC(赤;FPEと重複)情報基準は、対をプロット
モデル順序。 FPEとAICのプロットはほぼ同じであることに注意してください。 右:
HQを使用した最適なモデルオーダーのすべてのウィンドウに配布
情報基準。 垂直マーカーは分布を意味します。 お問い合わせ
分布は、9の周りのピークと別の1つのピークで、やや奇妙です
14時頃*

## 5.4.3。 最終モデルに適合
その後、次のGUIがポップアップします。

![スクリーンショット 2023-08-24 に 11 06 07 PM](https://github.com/sccn/SIFT/assets/1872705/7709ec02-78fd-4b66-bae0-e251ac394f05)

*充填キャプション。 モデルオーダー推定の最後にポップアップするGUI。 * 必須

モデルに合う準備ができました。 前のクエリウィンドウで**OK**を押すと、メニュー項目を呼び出します**ツール > サイズ > モデルフィッティングと検証 > AMVAR モデル** または下記のコマンドラインコールを使用します。

```matlab
EEG = pop_est_fitMVAR(EEG);
```

前のディスカッションでは、モデルの注文オプションを**15**に設定します。 最終セット
変数は下記の表で示されます:

|                           |                  |
|---------------------------|------------------|
| オプション | バリュー |
お問い合わせ **MVARアルゴリズムを選択してください** | **Vieira-Morf** |
|**窓長さ(秒)** |**0.4** (400ms) |
お問い合わせ **ステップサイズ(秒)** | **0.01** (10ms) |
|************************************************

![スクリーンショット 2023-08-25 1 19 50 PM](https://github.com/sccn/SIFT/assets/1872705/8168708b-bac2-4079-b22a-fb274f43a95f)

*充填キャプション。 このGUIでは、モデルオーダー推定のパラメータを入力することができます。 選択したパラメータの最終セット
モデル付属品のため。 Vieira-Morf を選択しました
アルゴリズム、0.01秒のステップサイズの0.4秒の窓の長さ、
15のモデル注文。 OKをクリックすると、進捗バーが表示されます
モデルフィットアルゴリズムの状態。 * 必須

[OK] をクリックして続行します。 SIFT の sanity チェックが進んで生成される
モデルの有効なセットを選択したことを示す警告やエラーなし
変数、次示すように。

![スクリーンショット 2023-08-25 1 20 24 PM](https://github.com/sccn/SIFT/assets/1872705/0b89221c-1b2a-4e0c-9246-0a9721a01da4)

*充填キャプション。 SIFT サンティチェック * 必須

GUI を使いたくない場合は、コマンドラインから以下のように実行できます。

```matlab
EEG = pop_est_fitMVAR( EEG, 'nogui', 'Algorithm', 'Vieira-Morf', 'ModelOrder', 15, 'WindowLength', 0.4, 'WindowStepSize', 0.01, 'verb', 1); 
```

各条件ではVAR\[15\]モデルが適合します。
238 ウィンドウのそれぞれ。 進捗バーが表示されるようになりました。
各条件のためのモデル付属品の進歩。 速度によって
コンピュータはしばらくかかることがありますので、休憩やヨガをしたりしたいかもしれません。 コンピューターメモリが少ない場合や、
プロセッサ速度の問題は、*ステップサイズを0.03 sec*に増加できます。
これは、まだ生産している間計算の時間要求を減らします
このチュートリアルの残りの部分と同様に結果。

## 5.4.4.4.4. 適合モデルの検証

そのヨガのセッションとモデルからリフレッシュした後
各条件に合わせて、装着したモデルを検証する必要があります。
メニュー項目を選択 ツール > SIFT > モデル継手と検証 > 検証 コマンドラインでモデル**またはタイプ:

```matlab
 pop_est_validateMVAR(EEG);
```

下の図に示す GUI が表示されます。 ここでは、残留物の白さ、パーセントをチェックするオプションがあります
一貫性、および各(またはランダムサブセット)のモデル安定性
窓。 セクション3.6で議論したように、残留白度テスト
Portmanteau と autocorrelation の相関のためのテストが含まれています
モデルの残留物(モデルが悪いことを示すことができる)。 お問い合わせ
Ljung-Box、Box-Pierce、Li-McLeodから選択するオプションがあります。
多variateのportmanteauテストおよび簡単なAutocorrelation機能
テスト。 パーセントの一貫性は、相関の分数を表します
モデルによって捕獲される元のデータの構造、その間
モデルの安定性は安定性/文様のためのeigenvalueテストを実行します
プロセス。 このGUIのオプションは、以下の表に示すように設定する必要があります。



|                                  |                 |
|----------------------------------|-----------------|
| オプション | バリュー |
|** レジデンシャルの白さチェック** |
| 重要度** | 0.05** |
| 個人情報保護方針
| **チェックモデルの安定性** | **
|**% 窓からサンプルまで** |**100** |

![スクリーンショット 2023-08-25 に 1 39 39](https://github.com/sccn/SIFT/assets/1872705/de44eb6f-401e-405f-81cf-e014adf85624)

*充填キャプション。 生成されるモデル検証GUI
`pop_est_validateMVAR()`お問い合わせ ここでは、ホワイトネスのホワイトネスを確認するために選ぶことができます
残留物、パーセントの一貫性、およびモデルの安定性(または一部)
ウィンドウのランダムサブセット。 この例では、
p\<0.05 の白さテストの意義 * 必須

[OK] をクリックして続行します。 進捗バーのシーケンスが表示されるようになりました
各条件のため。 しばらくお待ちください。

モデル検証ルーチンが完了したら、参照してください
以下の図のように、2つの条件ごとに示される結果。 トップパネル
各図は、ホワイトネステストの結果を関数として示します
ウィンドウインデックス(一時的な優先順位順にソート)。 お問い合わせ
portmanteauテストでは、p-valueをプロットし、受諾を行なう
相関残留物のヌル仮説 (例: 1-*p* は *p* が
null 仮説の拒絶に対する p-value)。 0.05を超える価値
(青色ライン)は残留物がp\<0.05で白であることを示します
レベル。 ACF試験(赤)では、その確率を証明しました。
観察される ACF 係数は白のための予想される間隔にあります
残留資格 0.95より大きい価値は残留物がで白いです示します
p\<0.05 レベル。 白色度テストを通過する窓のほんの一部
伝説に記されています。 ACFテストはすべてのウィンドウを分類することに注意してください
ポートマントーのテスト中に白い残留物を持っているように(それははるかにあります
より保守的な)ほとんどのウィンドウが白であることを示します。 ふりがな
エポックの端付近の窓の範囲が異常に失敗するという事実
ポートマントーのテストは、少しでも使用したいことを示すかもしれません
より大きいモデル順序(例えば、*p*=16)または多分より小さい窓のサイズ(へ
局所的な局所性を改善して下さい)。

中間のパネルは増加する上昇の一貫性のプロットされたversusを示します
ウィンドウインデックス。 PCが確実に高く(μ≈87%)、提案することに注意してください
適度なモデル適合。

下のパネルは各ウィンドウの安定性指数を示します。 上記値
または 0 近くでは、不安定な (およびおそらく非静止) モデルを示します。 お問い合わせ
この場合、追加の事前処理を試みたり、短縮したりすることもあります。
データの局所的な文具を改善するためのウィンドウの長さ。 私たちの例では、
安定性指数は安定/静止を示す、確実に低いです
モデル。

バリデーションチェックは、合理的にフィットするモデルを示しています(ただし)
フィット感の改善のためのお部屋がございます。 わたしたちの想い
今、私たちは、スペクトル/コネクティビティに進むことができますこれで快適に
推定と視覚化。

![スクリーンショット 2023-08-25 1 46 27 PM](https://github.com/sccn/SIFT/assets/1872705/738fb14a-c872-489a-a9b0-6e62ef3ebdb1)

*充填キャプション。 モデル検証の結果
RespWrong(トップ)とRespCorr(ボトム)条件。 各条件のために、a
バリデーション・スタディティスティックは、ウィンドウ・インデックス(順序でソート)をプロットしています。
一時的な優先順位)。 1つのウィンドウのみが利用可能な場合、バーのプロットは
代わりに生成します。 トップパネルは重要なレベルを示します
相関残留物の仮説を拒否する。 ポートマントーのために
テスト(LMP, Box-Pierce, Ljung-Box), 値より 0.05 (完了ライン), 値より大きい 0.95 p > 0.05 レベルの白残留物を示します. 中央パネルは、パーセントの一貫性を示しています。 ボトムパネルは、安定性指数を示しています。 * 必須
