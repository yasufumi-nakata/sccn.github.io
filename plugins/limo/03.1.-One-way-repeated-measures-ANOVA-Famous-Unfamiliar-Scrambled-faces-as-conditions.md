---
layout: default
parent: LIMO
grand_parent: Plugins
render_with_liquid: false

title: 03.1.-One-way-repeated-measures-ANOVA-(Famous,-Unfamiliar,-Scrambled-faces-as-conditions)
nav_title: "03.1.-片道対応-ANOVA-(ファムース、非ファミリア、スクランブル・フェイス・アス・コンディション)"
long_title: 03.1.-One-way-repeated-measures-ANOVA-(Famous,-Unfamiliar,-Scrambled-faces-as-conditions)
---
ここでは、グループレベルのANOVAを実行するために3つの基本条件を使用します。 LIMOは動く [階層モデル](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/2016_SanDiego_StatisticalanalysisofEEGdata.pdf), 被写体レベルのGLM(最初のレベル), グループレベルでのGLM(秒単位). データについていくつかの仮定の下で, これは、ランダムな効果として、すべての被験者のためのすべての試験で混合モデル解析を実行することと等しいです - しかし、はるかに高速に計算します. 

# 第一次レベルの分析
ANOVA_Faces として設計 1 の名前を変更し、現在の変数の削除を行います。[図6](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/6.jpg))。 「新規」をクリックして、興味の変数を追加します。ここでは、フェイスタイプを選択します。[数字 7](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/7.jpg))。 OKを押して、その変数を追加し、再度OKを押して設計選択を閉じます。 LIMO MEEGの設計を作成し、モデルパラメータを計算する準備が整います(図8用) [採用情報](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/8a.jpg), [スペクトル](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/8b.jpg) または [ログイン](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/8c.jpg))。 データ型(ERP、スペクトラム、ERSP)を入力し、時間や周波数範囲を制限する場合があります。 デフォルトメソッド(ウェイト・イースト・スクエア)は、データ・フレームよりも多くのトライアルを持っている限り、優先するオプションです。 

![プロフィール 6.設計を編集して下さい](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/6.jpg) 
_フィギュア 6. デザインを編集する_  

![図7. 新しいデザインを作成する](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/7.jpg) 
_フィギュア 7. 新しいデザインを作成する_

これは以下のようにコマンドラインで実行できます。
``` matlab
% 1st level analysis - specify the design
% We ignore the repetition levels using the variable 'face_type'
STUDY = std_makedesign(STUDY, ALLEEG, 1, 'name','ANOVA_Faces','delfiles','off','defaultdesign','off',...
    'variable1','face_type','values1',{'famous','scrambled','unfamiliar'},'vartype1','categorical',...
    'subjselect',{'sub-002','sub-003','sub-004','sub-005','sub-006','sub-007','sub-008','sub-009',...
    'sub-010','sub-011','sub-012','sub-013','sub-014','sub-015','sub-016','sub-017','sub-018','sub-019'});
[STUDY, EEG] = pop_savestudy( STUDY, EEG, 'savemode','resave');
```

![図8a. LIMO 重くされたイースト スクエア(WLS)を使用してERPのための推定モデル変数](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/8a.jpg) 
``` matlab
STUDY  = pop_limo(STUDY, ALLEEG, 'method','WLS','measure','daterp','timelim',[-50 650],...
    'erase','on','splitreg','off','interaction','off');
```  

![図8b. LIMO 重量付きイーストスクエア(WLS)を使用したスペクトルのモデルパラメータを推定](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/8b.jpg) 
``` matlab
STUDY  = pop_limo(STUDY, ALLEEG, 'method','WLS','measure','datspec','freqlim',[3 45],...
    'erase','on','splitreg','off','interaction','off');
```  

![図8c. LIMO 重量付きイーストスクエア(WLS)を使用したERSPのモデルパラメータを推定](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/8c.jpg) 
``` matlab
STUDY  = pop_limo(STUDY, ALLEEG, 'method','WLS','measure','dattimef',...
    'timelim',[-50 650],'freqlim',[3 45],'erase','on','splitreg','off','interaction','off');
```
スタッフ 8. モデルパラメータを推定する_  

数分後に、すべての被写体が処理されます。設計は構築され、パラメータが推定されます。 すべての分析は、設計の名前、測定分析、スペース、および使用方法のフォルダ内の各被写体派のフォルダ内に表示されます。
`/derivatives/sub-002/eeg/ ANOVA_Faces_GLM_Channels_Time_WLS`

インサイドは抽出されたデータ(Yr.mat)、モデル化されたデータ(Yhat.mat)、モデルパラメータ(Betas.mat)、モデル残留物(Res.mat)、モデルフィット(R2.mat)、統計効果(condition_effect_1.mat)、モデル情報自体(LIMO.mat)です。  

他のいくつかの便利なファイルもあります。 
-	LIMO_face_detection は、使用されるすべてのファイルをリストする txt ファイルのフォルダーで、これらはグループレベルの分析に役立ちます
-	LIMO_face_detection/limo_batch_report は、 psom のバッチファイルとどのファイルでも失敗したリストを含むフォルダーです。また、psom パイプラインも含まれています。  

上記の分析はコマンドラインで以下のように実行できます。  

# 第2レベルの分析

各被写体には、4つのモデルパラメータ(ベータ):馴染みのある、スクランブルされた、非familiar(設計をするときに表示される順序で保存)と最後のパラメータは、対象固有の定数です。 1方向のANOVAは、これらのベータ値(ファイル)を入力するだけで、3つのレベルを持つ単一の要因として設定します。  

研究クリック --> EEGデータの線形移動 --> 2ndレベル分析()[図9](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/9.jpg)).

![プロフィール 9. LIMO第2レベル呼出し](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/9.jpg) 
スタッフ 9. LIMO第2レベルを呼ぶ_  

1. *グループレベルのチャンネル位置ファイル*をロードします。これは、デリバティブフォルダのルートにあるはずです()[図10](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/10.jpg))
2. 新しいディレクトリ('1way_ANOVA')を作り、この新しい解析を保存し、*workingディレクトリ*として選択します。[図11](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/11.jpg)) 
3. *ANOVA/ANCOVA* をクリック[図12](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/12.jpg)) 必要に応じて情報を記入します。 フルスケール解析 --> 繰り返し測定 ANOVA --> 1 グループ --> 3 レベルの 1 つの要因 
4. [1 2 3] を分析するベータファイル*を選択し、'faces' という名前を入力します。[図13](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/13.jpg))  

![図10. ロードグループレベルのチャネル位置ファイル](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/10.jpg) 
_Figure 10. ロードグループ レベルのチャネルの場所 file_ 

![図11. 作業ディレクトリの選択](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/11.jpg) 
_Figure 11. 作業ディレクトリを選択_ 

![図12。 1ウェイの繰り返し測定ANOVAを設定する](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/12.jpg) 
スタッフ 12. 1つの方法によって繰り返される測定ANOVA_をセットアップして下さい 

![図13. ベータファイル(ERP、すなわちチャンネルタイムWLS)とパラメータに示されている](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/13.jpg) 
スタッフ 13。 ベータファイル(ERP、すなわちチャンネルタイムWLS)とパラメータ_ 

設計行列がポップアップする必要があります([図14](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/14.jpg))、分析を開始するために「はい」に答えます。

![図14. 1方向ANOVA 設計行列(条件1列+定数)](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/14.jpg) 
_Figure 14. 1ウェイANOVA 設計行列(条件1列+定数)_ 

これらの手順はコマンドラインで以下のように実行できます。  
```matlab
% 2nd level analysis - ANOVA on Beta parameters 1 2 3
chanlocs = [STUDY.filepath filesep 'limo_gp_level_chanlocs.mat'];
mkdir([STUDY.filepath filesep '1-way-ANOVA'])
cd([STUDY.filepath filesep '1-way-ANOVA'])
% ERP
limo_random_select('Repeated Measures ANOVA',chanlocs,'LIMOfiles',...
    {[STUDY.filepath filesep 'LIMO_Face_detection' filesep 'Beta_files_ANOVA_Faces_GLM_Channels_Time_WLS.txt']},...
    'analysis_type','Full scalp analysis','parameters',{[1 2 3]},...
    'factor names',{'face'},'type','Channels','nboot',1000,'tfce',0,'skip design check','yes');
% Spectrum
limo_random_select('Repeated Measures ANOVA',chanlocs,'LIMOfiles',...
    {[STUDY.filepath filesep 'LIMO_Face_detection' filesep 'Beta_files_ANOVA_Faces_GLM_Channels_Frequency_WLS.txt']},...
    'analysis_type','Full scalp analysis','parameters',{[1 2 3]},...
    'factor names',{'face'},'type','Channels','nboot',1000,'tfce',0,'skip design check','yes');
% ERSP
limo_random_select('Repeated Measures ANOVA',chanlocs,'LIMOfiles',...
    {[STUDY.filepath filesep 'LIMO_Face_detection' filesep 'Beta_files_ANOVA_Faces_GLM_Channels_Time-Frequency_WLS.txt']},...
    'analysis_type','Full scalp analysis','parameters',{[1 2 3]},...
    'factor names',{'face'},'type','Channels','nboot',1000,'tfce',0,'skip design check','yes');
```

2番目のレベルGUIを終了し、LIMO結果を「プロット」ボタンを押して、ANOVA結果を自動的に提案します。

![Plot ボタン -- 結果をプロットする呼び出し](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/pre15.jpg) 

デフォルトでは、bootstrap オプションは'off' で、ANOVA は素早く計算する必要があります。 ANOVAフォルダ1ウェイでは、データ(Yr.mat)、統計効果(Rep_ANOVA_Main_effect_1_faces.mat)、モデル情報自体(LIMO.mat)が作成されています。

複数の比較方法(例:クラスタリング)を選択し、その後、ブートストラップ(一度だけ行う)を計算します。 数字が更新されるとしばらく経ちます。 新しいH0フォルダには、リサンプリングテーブル(boot_table.mat)、nullデータ(centered_data.mat)、およびH0下にあるブートストラップされた統計結果があります。 コマンドウィンドウで異なるクラスターの結果を報告します。 

![図15. 1-way ANOVA ERP 有名な顔対スクランブル対比類のない結果](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/15a.jpg) 
![図15. 1方向ANOVA 有名な顔対スクランブル対比類のないスペクトラム結果](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/15b.jpg) 
![図15. 1方向 ANOVA ERSP 有名な顔対スクランブル対比類のない結果](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/15c.jpg) 
_Figure 15. 1ウェイANOVA 有名な顔対スクランブル対比類のない結果_

## コントラスト

この段階では、ANOVAの結果は、その3つの条件が異なる場所と時刻をお伝えします。 どの条件が他のものと異なるかを確認するには、ポストホックのコントラストは、馴染みのある顔とスクランブルの顔 [1 -1 0] の間のテストを実行することができ、非ファミリアは対スクランブル顔 [0 -1 1] と馴染みのある顔対非ファミリア面 [1 0 -1]. より複雑なコントラストも考えられます。*facesとscrambledの[0.5 -1 0.5]*を試してみましょう。これは、顔を含まない画像を含む顔を比較します。 これは、統計ソフトウェアで実行するのと同じ種類のコントラスト/ポストホック分析です。

主要な LIMO MEEG GUI または結果 GUI から、 コントラスト マネージャーをクリックし、 ANOVA 用に作成した「LIMO.mat」ファイルを選択します。 コントラストマネジャーは設計マトリクスを示し、コンピュートのコントラストを入力することができます()[数字 16](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/16.jpg)) をクリックし、「完了」をクリックします。 コントラストと関連するブートストラップが計算されます。 これらの分析は、主に(i)が繰り返されたANOVAモデル内で計算されているため、(i)、(i)、実行中のアドホックtテストとは異なることに注意してください。つまり、すべての条件と(ii)の会計は、F統計(例えば、ess*ファイルとして保存)に依存する方向性ではありません。

![図16. コントラストマネージャ ](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/16.jpg) 
スタッフ 16. デザインマトリクス(白)を示すコントラストマネジャー:馴染みのある顔、スクランブルされた顔、非顔、定数)とコントラスト馴染みのある顔 > スクランブルフェイス。_  

このステップはコマンドラインで以下のように実行できます。  

```matlab
% add contrast famous+unfamiliar>scrambled
limo_contrast(fullfile(pwd,'Yr.mat'),fullfile(pwd,'LIMO.mat'), 3 ,[0.5 -1 0.5]); % compute a new contrast
limo_contrast(fullfile(pwd,'Yr.mat'),fullfile(pwd,'LIMO.mat'), 4);               % do the bootstrap of the last contrast
```  

結果は、新しく作成した「ess*.mat」ファイルを「image all」から選択し、「コースプロット」を使用して、差分時間コース(図17用)を表示することで再び表示できます。 [採用情報](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/17a.jpg), [スペクトラム](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/17b.jpg) そして、 [ログイン](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/17c.jpg)).  

![図17a. ERP結果のコントラスト ](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/17a.jpg) 
```matlab
limo_eeg(5,pwd) % channel*time imagesc for both effects and contrast
limo_display_results(3,'ess_1.mat',pwd,0.05,2,fullfile(pwd,'LIMO.mat'),0,'channels',49); % course plot
saveas(gcf, 'contrast_timecourse.fig'); close(gcf)
```
![図17b. スペクトル結果のコントラスト ](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/17b.jpg) 
```matlab
limo_eeg(5,pwd) % channel*time imagesc for both effects and contrast
limo_display_results(3,'ess_1.mat',pwd,0.05,2,fullfile(pwd,'LIMO.mat'),0,'channels',49); % course plot
saveas(gcf, 'contrast_specprofile.fig'); close(gcf)
```

![図17c。 ERSPの対照結果 ](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/17c.jpg) 
```matlab
limo_eeg(5,pwd) % channel*time imagesc for both effects and contrast
limo_display_results(3,'ess_1.mat',pwd,0.05,2,fullfile(pwd,'LIMO.mat'),0,'channels',49); % course plot
saveas(gcf, 'contrast_timecourse.fig'); close(gcf)
```
スタッフ 17. コントラストの結果 [0.5 -1 0.5 0] i.e. (顔 - scrambled) 0_ 

