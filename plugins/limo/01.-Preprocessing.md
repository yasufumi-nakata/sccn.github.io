---
layout: default
parent: LIMO
grand_parent: Plugins
render_with_liquid: false

title: 01.-Preprocessing
long_title: 01.-Preprocessing
---
# チュートリアルのデータ

このチュートリアルでは、使い方を教えることを目指しています [リモメグ](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_tools/wiki)、との組合せで [エグラボスタディ](https://sccn.ucsd.edu/wiki/Chapter_02:_STUDY_Creation)お問い合わせ 始めるためには、慣れている必要があります [エッグラボ](https://sccn.ucsd.edu/eeglab/index.php)お問い合わせ また、Matlab パスに LIMO ツールのサブディレクトリがリストされていることを確認してください。

このチュートリアルで使用されるデータは、 [ウェイクマンとヘンソン (2015)](https://www.nature.com/articles/sdata20151)お問い合わせ この実験では、有名な、非ファミリアとスクランブルされた顔を見ながら、MEG-EEGデータを収集しました。 各画像は2回繰り返されます(例の50%と5〜10の刺激が他の50%に分けて)、その左右のインデックスフィンガーで2つのキーを押下し、各画像が平均比例した対称を示す。  

データは、Dung Truong、Ramon Martinez、Arnaud Delormeによって抽出、タイミング補正、電極位置再指向、イベント録画)準備され、 [オープンニューロ](https://openneuro.org/datasets/ds002718/versions/1.0.2).

# データプリプロセスパイプラインスクリプト

データはに従って組織されます [脳イメージングデータ構造](https://bids.neuroimaging.io/), 特に [EEG BIDS拡張子](https://www.nature.com/articles/s41597-019-0104-8)お問い合わせ ファイルの整理と名前付け方法を見て少し時間を費やす価値があります。 EEGLABはまた、専用の [bids-matlab-tools と呼ばれる BIDS ツール](https://raw.githubusercontent.com/sccn/bids-matlab-tools) BIDSデータセットの作成、エクスポート、インポート EEGLAB プラグインマネージャを使用して、下記のコードを実行する前にインストールする必要があります。 

データをダウンロードしたら、以下のコードを実行できます。(特定のパスでXを変更する)ファイルをコピーして貼り付けて、絶え間ない処理済みデータを取得できます。 あるいはダウンロード [コードはこちら](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/code/henson_wakeman_preprocess.m)お問い合わせ 患者様は、このステップは数時間かかります。

```matlab
% start EEGLAB
clear variables
[ALLEEG, EEG, CURRENTSET, ALLCOM] = eeglab;

% import BIDS
bidsfolder      = 'F:\WakemanHenson_Faces\eeg';
[STUDY, ALLEEG] = pop_importbids(bidsfolder, 'bidsevent','on','bidschanloc','on', ...
    'eventtype', 'trial_type', 'outputdir' ,fullfile(bidsfolder,'newderivatives'), 'studyName','Face_detection');
ALLEEG = pop_select( ALLEEG, 'nochannel',{'061','062','063','064'});
CURRENTSTUDY = 1; EEG = ALLEEG; CURRENTSET = 1:length(EEG);

% reorient if using previous version of the data
EEG = pop_chanedit(EEG,'nosedir','+Y');

% Clean data - just the bad channels
EEG = pop_clean_rawdata( EEG,'FlatlineCriterion',5,'ChannelCriterion',0.8,...
    'LineNoiseCriterion',4,'Highpass',[0.25 0.75] ,...
    'BurstCriterion','off','WindowCriterion','off','BurstRejection','off',...
    'Distance','Euclidian','WindowCriterionTolerances','off' );

% Rereference using average reference
EEG = pop_reref( EEG,[],'interpchan',[]);

% Run ICA and flag artifactual components using IClabel
for s=1:size(EEG,2)
    EEG(s) = pop_runica(EEG(s), 'icatype','runica','concatcond','on','options',{'pca',EEG(s).nbchan-1});
    EEG(s) = pop_iclabel(EEG(s),'default');
    EEG(s) = pop_icflag(EEG(s),[NaN NaN;0.8 1;0.8 1;NaN NaN;NaN NaN;NaN NaN;NaN NaN]);
    EEG(s) = pop_subcomp(EEG(s), find(EEG(s).reject.gcompreject), 0);
end

% clear data using ASR - just the bad epochs
EEG = pop_clean_rawdata( EEG,'FlatlineCriterion','off','ChannelCriterion','off',...
    'LineNoiseCriterion','off','Highpass','off','BurstCriterion',20,...
    'WindowCriterion',0.25,'BurstRejection','on','Distance','Euclidian',...
    'WindowCriterionTolerances',[-Inf 7] );

% Extract data epochs (no baseline removed)
EEG    = pop_epoch( EEG,{'famous_new','famous_second_early','famous_second_late','scrambled_new','scrambled_second_early','scrambled_second_late','unfamiliar_new','unfamiliar_second_early','unfamiliar_second_late'},...
    [-0.5 1] ,'epochinfo','yes');
EEG    = eeg_checkset(EEG);
EEG    = pop_saveset(EEG, 'savemode', 'resave');
ALLEEG = EEG;

% Create study design
STUDY  = std_checkset(STUDY, ALLEEG);
STUDY  = std_makedesign(STUDY, EEG, 1, 'name','STUDY.FaceRepetition','delfiles','off','defaultdesign','off','variable1','type','values1',{});
eeglab redraw
```

# 前処理されたEEGLAB STUDYの読み込み

データの処理後、データのクリーン化、エポックマーク、およびSTUDYが作成されます。 EEGLABメニューから勉強をロードする(ファイル --> 既存の研究をロードする - [図1](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/1.jpg))すべてのデータがそこにあることを確認し、(Study --> 編集研究情報 - [図2](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/1.jpg))。 合計では、サブ-002 からサブ-019 までの名前が 18 件あります。 

![プロフィール 1. EEGLAB STUDYのローディング](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/1.jpg)
スタッフ 1. EEGLAB STUDY の読み込み  

![プロフィール 2. ウェイクマン・ヘンソン スタディ](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/2.jpg)
_フィギュア 2. ウェイクマン・ヘンソン スチュディ_  

# Precompute STUDY対策

LIMO MEEGは、サブジェクトレベルで一般的なリニアモデルとの階層的なアプローチを使用してデータをモデル化し、グループレベルでは、堅牢なメソッドで得られたパラメータをテストします。 被験者レベルの平均を生成し、グループレベルでそれらの平均値に関する統計をすることができます。 差(および利点)は、被験者固有のベースラインが削除され、試用期間が経理され、悪い被験者はアカウントされます。 詳しくはこちらをご覧ください [サンディエゴ2016 pdfとしての講義](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/2016_SanDiego_StatisticalanalysisofEEGdata.pdf) および/または [ツイート](https://youtu.be/KfnN51frbuI).

## ステップ1 - プリコンプト単価測定(s)

LIMO MEEGを使用して設計に関係なく、我々は、各被験者のための条件関連パラメータを取得するために、単一の試験を必要とすることを意味します。 EEGLABは、すべての試験データ対策をエクスポートし、設計に応じて、関連するものだけをLIMO EEGに渡します(これはグループ間のスペクトルを比較するための手段である場合であっても)。 

ERP および/または Spectra および/または ERSP を作成する (スタディ --> Precomputeチャンネル対策 – [図3]((https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/3.jpg))。 この段階で、エポックに制限を設定('timelim'と'freqlim'を使用して)、または次のステージで統計分析を制限することができます(これは私たちが行うことです)。 ERPs では、ベースラインの補正を使用することができます。 `[-200 0]`お問い合わせ ERSPは長時間かかる場合があります。 ERP と Spectra のみ (もちろん、次のセクションで ERSP で LIMO を使うことはできません) から始めることができます。

![プロフィール 3. Precomputeチャネル対策](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/3.jpg)  
スタッフ 3. Precomputeチャンネル対策_  

単一のトライアル(erp、スペクトラム、erp)もコマンドラインで生成できます。  

```matlab
% Precompute ERP and Spectrum measures
[STUDY, EEG] = std_precomp(STUDY, EEG, {}, 'savetrials','on','interp','on','recompute','on',...
    'erp','on','erpparams', {'rmbase' [-200 0]}, 'spec','on',...
    'ersp','on','itc','on', 'specparams',{'specmode','fft','logtrials','off'});
```

## ステップ2 - あなたのデザインを作成する

利用可能な条件と試験情報から、利用可能な多くのオプションがあります。 このチュートリアルでは、最も一般的なものを確認します。 例えば、3つの分類値(famous, scambled, unfamiliar Face)を取る独立した変数 "face_type" を選ぶことができます。 このシンプルなデザインを使い、チュートリアル(Study --> Select/Edit Study design(s)に沿って行くと、より複雑なものを作成します。 [図4](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/4.jpg)).  

![プロフィール 4. 選択/編集の研究の設計(s)](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/4.jpg)
スタッフ 4. 選択/編集研究設計(s)_  

各デザインはここから生成できます。次のセクションでは、それぞれのデザインが異なる時に表示されます。 今のところ、「要因のリスト」を見てみましょう([図5](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/5.jpg))。 このリストは、私たちがデザインを作ることができるすべてのカテゴリ変数(このリストは、独立した変数の「リスト要素」を選択した場合に表示されます)をリストします。 この要因のリストは、LIMOが最初のレベルで使用されます。 次のセクションでは、我々は1ウェイANOVAテストに精通の効果をします (すべての有名な対. すべての不慣れ対. すべてのスクランブル顔).  

![図5. 分類変数のリスト](https://raw.githubusercontent.com/LIMO-EEG-Toolbox/limo_meeg/master/resources/images/5.jpg)
スタッフ 5. 分類変数のリスト_  

# LIMOのデフォルトおよびサンプリング率の使用に注意して下さい

デフォルトでは、LIMO EEG は、各試験の重み付き最小平方フィートのアプローチを使用します。つまり、時間枠(ERP と ERSP)や周波数枠(Spectrum の場合)よりも多くの試行を目的とする必要があります。 こちらのデータは250Hzで、細心の注意を払っております。
 